

<!DOCTYPE html>


<html lang="en" >
<script data-ad-client="ca-pub-2479144310234386" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Chapter 11 Python Projects &#8212; Introduction To Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=365ca57ee442770a23c6" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=365ca57ee442770a23c6" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=365ca57ee442770a23c6"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chapters/chap_11';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Conclusion" href="conclusion.html" />
    <link rel="prev" title="Chapter 10 Introduction to Data Science" href="chap_10.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Introduction To Python - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Introduction To Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Introduction to Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="chap_1.html">Chapter 1: Introduction To Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap_2.html">Chapter 2 Basic syntax and data types</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap_3.html">Chapter 3: Control flow and functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap_4.html">Chapter 4: Modules and packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap_5.html">Chapter 5: Object-oriented programming</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap_6.html">Chapter 6: Exceptions and errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap_7.html">Chapter 7: File handling and data processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap_8.html">Chapter 8 File handling and data processing.</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap_9.html">Chapter 9 Introduction to Web Development with Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="chap_10.html">Chapter 10 Introduction to Data Science</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Chapter 11 Python Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="conclusion.html">Conclusion</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FriendlyUser/IntroToPython" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FriendlyUser/IntroToPython/issues/new?title=Issue%20on%20page%20%2Fchapters/chap_11.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/chapters/chap_11.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Chapter 11 Python Projects</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-argparse">Using argparse</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-pdf-to-pngs">Convert pdf to pngs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chat-gpt-blog-generation">Chat gpt blog generation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#investor-document-downloader">Investor document downloader</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-subtitles-for-youtube-videos">Generate Subtitles for Youtube Videos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scrapping-superbowl-results-with-pandas">Scrapping Superbowl results with pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-youtube-livestream-status">Getting youtube livestream status</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#natural-gas-analysis">Natural gas Analysis</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="chapter-11-python-projects">
<h1>Chapter 11 Python Projects<a class="headerlink" href="#chapter-11-python-projects" title="Permalink to this heading">#</a></h1>
<section id="using-argparse">
<h2>Using argparse<a class="headerlink" href="#using-argparse" title="Permalink to this heading">#</a></h2>
<p>argparse is a Python module that makes it easy to write command-line interfaces. It allows you to specify the arguments that your program should accept in a clean and organized way, and it takes care of handling the input and output for you.</p>
<p>Here’s an example of how to use argparse to parse command-line arguments in a Python script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">argparse</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">Python</span> <span class="n">module</span> <span class="n">that</span> <span class="n">makes</span> <span class="n">it</span> <span class="n">easy</span> <span class="n">to</span> <span class="n">write</span> <span class="n">command</span><span class="o">-</span><span class="n">line</span> <span class="n">interfaces</span><span class="o">.</span> <span class="n">It</span> <span class="n">allows</span> <span class="n">you</span> <span class="n">to</span> <span class="n">specify</span> <span class="n">the</span> <span class="n">arguments</span> <span class="n">that</span> <span class="n">your</span> <span class="n">program</span> <span class="n">should</span> <span class="n">accept</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">clean</span> <span class="ow">and</span> <span class="n">organized</span> <span class="n">way</span><span class="p">,</span> <span class="ow">and</span> <span class="n">it</span> <span class="n">takes</span> <span class="n">care</span> <span class="n">of</span> <span class="n">handling</span> <span class="n">the</span> <span class="nb">input</span> <span class="ow">and</span> <span class="n">output</span> <span class="k">for</span> <span class="n">you</span><span class="o">.</span>

<span class="n">Here</span><span class="s1">&#39;s an example of how to use argparse to parse command-line arguments in a Python script:</span>
</pre></div>
</div>
<p>This script defines a single command-line argument, –sum, which specifies whether the program should sum or find the maximum of the integers. If the –sum argument is not provided, the default action is to find the maximum.</p>
<p>To run this script, you would type something like python <a class="reference external" href="http://script.py">script.py</a> 1 2 3 –sum at the command line. This would cause the script to print 6, which is the sum of the integers 1, 2, and 3.</p>
<p>Here’s an example of how you might use argparse to write a command-line interface for a program that keeps track of the books that a bear has read:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Bear book tracker&#39;</span><span class="p">)</span>

<span class="c1"># Add a command to add a book to the bear&#39;s reading list</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--add&#39;</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="s1">&#39;book&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">&#39;add a book to the reading list&#39;</span><span class="p">)</span>

<span class="c1"># Add a command to list the books that the bear has read</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--list&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s1">&#39;store_true&#39;</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s1">&#39;list the books that the bear has read&#39;</span><span class="p">)</span>

<span class="c1"># Parse the arguments</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="c1"># Initialize an empty list to store the bear&#39;s books</span>
<span class="n">books</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># If the --add argument was provided, add the book to the list</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">book</span><span class="p">:</span>
    <span class="n">books</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">book</span><span class="p">)</span>

<span class="c1"># If the --list argument was provided, print the list of books</span>
<span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Bear&#39;s books:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">book</span> <span class="ow">in</span> <span class="n">books</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">book</span><span class="p">)</span>

</pre></div>
</div>
<p>To use this program, you would type something like python book_tracker.py –add “The Giving Tree” to add a book to the bear’s reading list, or python book_tracker.py –list to view the list of books.</p>
<p>I hope this helps give you a basic understanding of how argparse works!</p>
</section>
<section id="convert-pdf-to-pngs">
<h2>Convert pdf to pngs<a class="headerlink" href="#convert-pdf-to-pngs" title="Permalink to this heading">#</a></h2>
<p>ImageMagick is a software suite to create, edit, and compose bitmap images. It can read, convert and write images in a variety of formats (over 100) including DPX, EXR, GIF, JPEG, JPEG-2000, PDF, PhotoCD, PNG, Postscript, SVG, and TIFF. ImageMagick is used to translate, flip, mirror, rotate, scale, shear and transform images, adjust image colors, apply various special effects, or draw text, lines, polyglines, ellipses and Bézier curves.</p>
<p>It is used by graphic designers, photographers, scientists and also used for creating thumbnails for websites, creating GIF animations, converting PDF pages to images and so on. ImageMagick can be used from the command-line or can be used as a programming library for software development.</p>
<p>You can call ImageMagick from Python using the <code class="docutils literal notranslate"><span class="pre">os</span></code> module, which provides a way to interface with the underlying operating system.</p>
<p>Here’s an example of how to use ImageMagick to convert an image from one format to another:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="n">input_image</span> <span class="o">=</span> <span class="s1">&#39;input.jpg&#39;</span>
<span class="n">output_image</span> <span class="o">=</span> <span class="s1">&#39;output.png&#39;</span>

<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;convert </span><span class="si">{</span><span class="n">input_image</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">output_image</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">convert</span></code> is the command-line utility provided by ImageMagick to convert images. The <code class="docutils literal notranslate"><span class="pre">input_image</span></code> variable specifies the path to the input image and <code class="docutils literal notranslate"><span class="pre">output_image</span></code> specifies the path to the output image. The <code class="docutils literal notranslate"><span class="pre">os.system</span></code> function is used to run the <code class="docutils literal notranslate"><span class="pre">convert</span></code> command, which converts the input image to the output image.</p>
<p>The convert utility is only available in imagemagick 6.</p>
<p>Note that this method is prone to security vulnerabilities, since it passes the parameters directly to the shell. To avoid these vulnerabilities, you can use the <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> module, which provides a more secure way of calling shell commands. Here’s an example of how to use the <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> module to call ImageMagick:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">subprocess</span>

<span class="n">input_image</span> <span class="o">=</span> <span class="s1">&#39;input.jpg&#39;</span>
<span class="n">output_image</span> <span class="o">=</span> <span class="s1">&#39;output.png&#39;</span>

<span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;convert&#39;</span><span class="p">,</span> <span class="n">input_image</span><span class="p">,</span> <span class="n">output_image</span><span class="p">])</span>
</pre></div>
</div>
<p>In this example, the <code class="docutils literal notranslate"><span class="pre">subprocess.run</span></code> function is used to run the <code class="docutils literal notranslate"><span class="pre">convert</span></code> command, and the parameters are passed as a list, rather than as a string. This is a more secure way of calling shell commands, as it avoids shell injection attacks.</p>
<p>You can call ImageMagick from Python using the <code class="docutils literal notranslate"><span class="pre">os</span></code> module, which provides a way to interface with the underlying operating system.</p>
<p>Here’s an example of how to use ImageMagick to convert an image from one format to another:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>import os

input_image = &#39;input.jpg&#39;
output_image = &#39;output.png&#39;

os.system(f&#39;convert {input_image} {output\_image}&#39;)`
</pre></div>
</div>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">convert</span></code> is the command-line utility provided by ImageMagick to convert images. The <code class="docutils literal notranslate"><span class="pre">input_image</span></code> variable specifies the path to the input image and <code class="docutils literal notranslate"><span class="pre">output_image</span></code> specifies the path to the output image. The <code class="docutils literal notranslate"><span class="pre">os.system</span></code> function is used to run the <code class="docutils literal notranslate"><span class="pre">convert</span></code> command, which converts the input image to the output image.</p>
<p>Note that this method is prone to security vulnerabilities, since it passes the parameters directly to the shell. To avoid these vulnerabilities, you can use the <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> module, which provides a more secure way of calling shell commands. Here’s an example of how to use the <code class="docutils literal notranslate"><span class="pre">subprocess</span></code> module to call ImageMagick:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>import subprocess

input_image = &#39;input.jpg&#39;
output_image = &#39;output.png&#39;

subprocess.run([&#39;convert&#39;, input_image, output_image])`
</pre></div>
</div>
<p>In this example, the <code class="docutils literal notranslate"><span class="pre">subprocess.run</span></code> function is used to run the <code class="docutils literal notranslate"><span class="pre">convert</span></code> command, and the parameters are passed as a list, rather than as a string. This is a more secure way of calling shell commands, as it avoids shell injection attacks.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">dir_list</span> <span class="o">=</span>  <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">full_file_name</span> <span class="ow">in</span> <span class="n">dir_list</span><span class="p">:</span>
        <span class="n">base_name</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">full_file_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extension</span> <span class="o">==</span> <span class="s1">&#39;.pdf&#39;</span><span class="p">:</span> <span class="c1"># then .pdf file --&gt; convert to image!</span>
            <span class="n">cmd_str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;convert&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;-density 400&#39;</span><span class="p">,</span>
                                <span class="n">full_file_name</span><span class="p">,</span>
                                <span class="s1">&#39;-flatten&#39;</span><span class="p">,</span>
                                <span class="n">base_name</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">])</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">cmd_str</span><span class="p">)</span>  <span class="c1"># echo command to terminal</span>
            <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="n">cmd_str</span><span class="p">)</span>  <span class="c1"># execute command</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<p>This is a Python script that uses the os module to convert all PDF files in the current directory to PNG images using ImageMagick. The main function lists all the files in the current directory using os.listdir, and then loops through each file name in dir_list. If the file extension is ‘.pdf’, the script splits the file name into its base name and extension using os.path.splitext, and then creates a command string using cmd_str that calls ImageMagick’s convert utility with the specified options.</p>
<p>The options used in this script are:</p>
<ul class="simple">
<li><p>density 400: sets the density of the output image, which affects its resolution.</p></li>
<li><p>flatten: combines all the layers of the PDF into a single image.</p></li>
</ul>
<p>The os.system function is then used to execute the command string, which converts the PDF file to a PNG image. The script prints the command string to the terminal to show what it’s doing, and the result is a set of PNG images, one for each PDF file in the directory.</p>
<p>ImageMagick is a versatile and powerful software suite that has many uses, including:</p>
<ol class="arabic simple">
<li><p>Image Conversion: ImageMagick can be used to convert images from one format to another, making it easier to work with different image formats.</p></li>
<li><p>Image Editing: ImageMagick can be used to perform basic image editing operations, such as cropping, resizing, rotating, and flipping images.</p></li>
<li><p>Image Compression: ImageMagick can be used to compress images, reducing their file size while maintaining image quality.</p></li>
<li><p>Image Manipulation: ImageMagick can be used to manipulate images in various ways, such as applying special effects, adding text and shapes, and blending multiple images together.</p></li>
<li><p>Thumbnail Creation: ImageMagick can be used to create thumbnails for websites, making it easier to manage large numbers of images.</p></li>
<li><p>Image Animation: ImageMagick can be used to create GIF animations from a sequence of images.</p></li>
<li><p>PDF Conversion: ImageMagick can be used to convert PDF pages to images, making it easier to work with PDF documents.</p></li>
<li><p>Image Processing: ImageMagick can be used for image processing tasks, such as adjusting image colors and removing noise from images.</p></li>
<li><p>Scientific Visualization: ImageMagick can be used in scientific visualization, such as for rendering 3D models or visualizing data.</p></li>
</ol>
<p>These are just a few examples of the many uses of ImageMagick. It is a highly versatile software suite that can be used in many different ways to work with images.</p>
<section id="references">
<h3>References<a class="headerlink" href="#references" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="github reference external" href="https://github.com/FriendlyUser/ELEC370/blob/master/Assignments/A1/html/pdfToPNGMagick.py">FriendlyUser/ELEC370</a></p></li>
</ul>
</section>
</section>
<section id="chat-gpt-blog-generation">
<h2>Chat gpt blog generation<a class="headerlink" href="#chat-gpt-blog-generation" title="Permalink to this heading">#</a></h2>
<p>ChatGPT is a large language model that has been trained using a technique called unsupervised learning, in which the model learns to generate text by being fed a large dataset of text. It is designed to generate human-like responses to prompts, and can be used for a variety of natural language processing tasks, such as language translation, text summarization, and question answering.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">pyChatGPT</span> <span class="kn">import</span> <span class="n">ChatGPT</span>
<span class="c1"># import yaml</span>
<span class="kn">from</span> <span class="nn">yaml</span> <span class="kn">import</span> <span class="n">load</span><span class="p">,</span> <span class="n">dump</span><span class="p">,</span> <span class="n">Loader</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">stability_sdk</span> <span class="kn">import</span> <span class="n">client</span>
<span class="kn">import</span> <span class="nn">stability_sdk.interfaces.gooseai.generation.generation_pb2</span> <span class="k">as</span> <span class="nn">generation</span>
<span class="c1"># Our Host URL should not be prepended with &quot;https&quot; nor should it have a trailing slash.</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;STABILITY_HOST&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;grpc.stability.ai:443&#39;</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;STABILITY_KEY&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;STABILITY_KEY&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">generate_image</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span><span class="nb">dict</span><span class="p">)</span><span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">prompt</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;imageArgs&#39;</span><span class="p">][</span><span class="s1">&#39;prompt&#39;</span><span class="p">]</span>
    <span class="n">stability_api</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">StabilityInference</span><span class="p">(</span>
        <span class="n">key</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;STABILITY_KEY&#39;</span><span class="p">],</span> <span class="c1"># API Key reference.</span>
        <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># Print debug messages.</span>
        <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;stable-diffusion-v1-5&quot;</span><span class="p">,</span> <span class="c1"># Set the engine to use for generation. </span>
        <span class="c1"># Available engines: stable-diffusion-v1 stable-diffusion-v1-5 stable-diffusion-512-v2-0 stable-diffusion-768-v2-0 </span>
        <span class="c1"># stable-diffusion-512-v2-1 stable-diffusion-768-v2-1 stable-inpainting-v1-0 stable-inpainting-512-v2-0</span>
    <span class="p">)</span>
    <span class="n">answers</span> <span class="o">=</span> <span class="n">stability_api</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
        <span class="n">prompt</span><span class="o">=</span><span class="n">prompt</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">resp</span> <span class="ow">in</span> <span class="n">answers</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">artifact</span> <span class="ow">in</span> <span class="n">resp</span><span class="o">.</span><span class="n">artifacts</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">artifact</span><span class="o">.</span><span class="n">finish_reason</span> <span class="o">==</span> <span class="n">generation</span><span class="o">.</span><span class="n">FILTER</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="s2">&quot;Your request activated the API&#39;s safety filters and could not be processed.&quot;</span>
                    <span class="s2">&quot;Please modify the prompt and try again.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">artifact</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">generation</span><span class="o">.</span><span class="n">ARTIFACT_IMAGE</span><span class="p">:</span>
                <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">binary</span><span class="p">))</span>
                <span class="c1"># images</span>
                <span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;images&quot;</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">artifact</span><span class="o">.</span><span class="n">seed</span><span class="p">)</span><span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span> <span class="c1"># Save our generated images with their seed number as the filename.</span>

<span class="k">def</span> <span class="nf">generate_frontmatter</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span><span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># open output file</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;outputFile&#39;</span><span class="p">]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># write frontmatter</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;---</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># get frontmatter</span>
        <span class="n">frontmatter</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;frontMatter&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">frontmatter</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;---</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># write body</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">use_programming_language</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">section_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># get programming language</span>
    <span class="n">programming_language</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;programmingLanguage&#39;</span><span class="p">]</span>
    <span class="c1"># use regex to find plain ``` and replace with ```programming_language</span>
    <span class="n">type_start_line</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">type_end_line</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># replace with code blocks with programming language</span>
    <span class="c1"># split lines by \n</span>
    <span class="n">modified_lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">section_text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">line</span> <span class="o">==</span> <span class="s1">&#39;```&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_start_line</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">type_start_line</span> <span class="o">=</span> <span class="n">i</span>
                <span class="c1"># append modified line</span>
                <span class="n">modified_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;```</span><span class="si">{</span><span class="n">programming_language</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># odd number of ``` so we are ending a code block</span>
                <span class="n">type_start_line</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="c1"># append modified line</span>
                <span class="n">modified_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;```&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># adjust line if type_start_line is not None</span>
            <span class="c1"># remove ` at the beginning of the line and the end of the line</span>
            <span class="k">if</span> <span class="n">type_start_line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># check for ` character at the beginning of the line</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;`&#39;</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="c1"># check for ` character at the end of the line</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;`&#39;</span><span class="p">:</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">modified_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>

    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">modified_lines</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">generate_body</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span><span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># read CHATGPT_TOKEN from os</span>
    <span class="n">CHATGPT_SESSION_TOKEN</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;CHATGPT_TOKEN&quot;</span><span class="p">)</span>
    <span class="c1"># print(CHATGPT_SESSION_TOKEN)</span>
    <span class="n">session_token</span> <span class="o">=</span> <span class="n">CHATGPT_SESSION_TOKEN</span>  <span class="c1"># `__Secure-next-auth.session-token` cookie from https://chat.openai.com/chat</span>
    <span class="n">api</span> <span class="o">=</span> <span class="n">ChatGPT</span><span class="p">(</span><span class="n">session_token</span><span class="p">)</span>  <span class="c1"># auth with session token</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;outputFile&#39;</span><span class="p">]</span>
    <span class="n">sections</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;sections&#39;</span><span class="p">]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
            <span class="c1"># check if str or dict</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">section</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">resp</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">section</span><span class="p">)</span>
                <span class="n">clean_message</span> <span class="o">=</span> <span class="n">use_programming_language</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">resp</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># assume dict</span>
                <span class="c1"># type and src from dict</span>
                <span class="n">input_type</span> <span class="o">=</span> <span class="n">section</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span>
                <span class="n">src</span> <span class="o">=</span> <span class="n">section</span><span class="p">[</span><span class="s1">&#39;src&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s1">&#39;file&#39;</span><span class="p">:</span>
                    <span class="c1"># read src from file</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">src_file</span><span class="p">:</span>
                        <span class="n">src_text</span> <span class="o">=</span> <span class="n">src_file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                    <span class="n">resp</span> <span class="o">=</span> <span class="n">api</span><span class="o">.</span><span class="n">send_message</span><span class="p">(</span><span class="n">src_text</span><span class="p">)</span>
                    <span class="n">clean_message</span> <span class="o">=</span> <span class="n">resp</span><span class="p">[</span><span class="s1">&#39;message&#39;</span><span class="p">]</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">clean_message</span><span class="p">)</span>
                    <span class="c1"># write original text</span>
                    <span class="n">programming_language</span> <span class="o">=</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;programmingLanguage&#39;</span><span class="p">]</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;```</span><span class="si">{</span><span class="n">programming_language</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">src_text</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2"> ```</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">clean_message</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--file&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s1">&#39;posts/chatgpt_blog_generation.yml&#39;</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="c1"># valid files exist</span>
    <span class="c1"># argparse for file eventually</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">cfg</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">Loader</span><span class="p">)</span>
    <span class="c1"># if file exists skip</span>
    <span class="c1"># if not run these functions</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;outputFile&#39;</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;file exists&#39;</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># if genImage is true, then makeImage</span>
    <span class="k">if</span> <span class="n">cfg</span><span class="p">[</span><span class="s1">&#39;imageArgs&#39;</span><span class="p">]:</span>
        <span class="n">generate_image</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
        <span class="k">pass</span>

    <span class="n">generate_frontmatter</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
    <span class="n">generate_body</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span> 
</pre></div>
</div>
<p>This is a Python script that uses the ChatGPT API, the pyChatGPT library, and the stability_sdk to generate text and images. The script takes in a configuration file in YAML format, which specifies the input text, the output file, and various settings such as the programming language to use for code blocks and the prompt for the image generation.
It uses the ChatGPT API to generate text in response to prompts specified in the configuration file. The script also uses the stability_sdk to generate images based on the prompt specified in the configuration file. The script also uses the Python Imaging Library (PIL) to save the generated images to a directory. Additionally, it processes the generated text, using regular expressions to replace plain backticks with code blocks in the specified programming language.</p>
<p>There are several ways to monetize a blog, including the following:</p>
<ol class="arabic simple">
<li><p>Advertising: You can place ads on your blog and earn money through pay-per-click or pay-per-impression programs such as Google AdSense.</p></li>
<li><p>Affiliate marketing: You can earn money by promoting other people’s products or services and receiving a commission for every sale made through your unique affiliate link.</p></li>
<li><p>Sponsored posts: You can write posts sponsored by a brand or company and receive payment for the promotion.</p></li>
<li><p>Selling products or services: You can sell your own products or services, such as e-books, courses, or consulting services, directly to your readers.</p></li>
<li><p>Crowdfunding: You can use platforms like Patreon or Kickstarter to raise money from your readers to support your blog or other projects.</p></li>
<li><p>Subscription models: You can offer exclusive content, access to a community or other perks for a recurring fee.</p></li>
</ol>
<p>It’s important to note that monetizing your blog requires consistent, high-quality content, and a sizable audience. It may take some time and effort to grow your blog and monetize it successfully.</p>
<p>Using AI to generate images can be beneficial in a variety of ways. Some reasons include:</p>
<ol class="arabic simple">
<li><p>Automation: AI-generated images can be produced quickly and at scale, reducing the time and resources required to create images manually.</p></li>
<li><p>Variation: AI-generated images can be easily customized to produce a wide range of variations, allowing for greater flexibility in image design.</p></li>
<li><p>Consistency: AI-generated images can be designed to maintain a consistent style or theme, making it easier to maintain a cohesive visual identity across a brand or product.</p></li>
<li><p>Cost-effectiveness: AI-generated images can be less expensive than hiring a professional photographer or graphic designer, making them more accessible to businesses with limited budgets.</p></li>
<li><p>Creative possibilities: AI-generated images can be used in creative ways, such as creating surreal or abstract imagery that would be difficult to achieve through traditional means.</p></li>
<li><p>Personalization: AI-generated images can be used to personalize content for targeted audience, resulting in higher engagement and conversion rates.</p></li>
<li><p>Efficiency: AI-generated images can be used to generate high-quality images for use in various applications, such as product advertising, web design, and mobile apps.</p></li>
</ol>
<p>Using AI to generate images can be beneficial in a variety of ways. Some reasons include:</p>
<ol class="arabic simple">
<li><p>Automation: AI-generated images can be produced quickly and at scale, reducing the time and resources required to create images manually.</p></li>
<li><p>Variation: AI-generated images can be easily customized to produce a wide range of variations, allowing for greater flexibility in image design.</p></li>
<li><p>Consistency: AI-generated images can be designed to maintain a consistent style or theme, making it easier to maintain a cohesive visual identity across a brand or product.</p></li>
<li><p>Cost-effectiveness: AI-generated images can be less expensive than hiring a professional photographer or graphic designer, making them more accessible to businesses with limited budgets.</p></li>
<li><p>Creative possibilities: AI-generated images can be used in creative ways, such as creating surreal or abstract imagery that would be difficult to achieve through traditional means.</p></li>
<li><p>Personalization: AI-generated images can be used to personalize content for targeted audience, resulting in higher engagement and conversion rates.</p></li>
<li><p>Efficiency: AI-generated images can be used to generate high-quality images for use in various applications, such as product advertising, web design, and mobile apps.</p></li>
</ol>
<p>AI has the potential to change blog writing in the future by making the process more efficient and personalized. For example, AI-powered writing assistants can help writers generate content faster by suggesting topics, outlining structure, and providing research and data to support their ideas. Additionally, AI-powered content generation can personalize blogs by analyzing audience data and tailoring the content to their interests and preferences. It can also generate images, infographics and videos to supplement the written content. However, it’s important to note that AI-generated content should be carefully evaluated for accuracy and bias, and should be used in conjunction with human editing and oversight to ensure high-quality and ethical results.</p>
<section id="id1">
<h3>References<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="github reference external" href="https://github.com/FriendlyUser/chatgpt-blog-generator">FriendlyUser/chatgpt-blog-generator</a></p></li>
</ul>
</section>
</section>
<section id="investor-document-downloader">
<h2>Investor document downloader<a class="headerlink" href="#investor-document-downloader" title="Permalink to this heading">#</a></h2>
<p>CSE exchange refers to the Canadian Securities Exchange, which is a stock exchange located in Canada. The CSE is a fully electronic exchange that provides a marketplace for the trading of securities listed on its platform. It offers a range of listing options, including equity, debt, and structured products, and operates with a focus on serving emerging and growth companies. The exchange aims to provide an efficient, transparent, and accessible marketplace for issuers and investors, and is regulated by the Ontario Securities Commission.</p>
<p>Downloading reports from the CSE exchange can provide valuable information for investors, traders, and other market participants. The reports contain data on market activity, financial performance, and other key metrics for the companies listed on the exchange. By accessing these reports, you can gain insight into the financial health and performance of the companies, which can help inform your investment decisions.</p>
<p>For example, the CSE provides annual and quarterly financial statements, press releases, and other disclosures for companies listed on the exchange. By downloading and reviewing these reports, you can get a better understanding of a company’s financial performance, including revenue, expenses, profits, and growth trends. This information can help you make more informed decisions about whether to buy, sell, or hold a company’s stock.</p>
<p>Additionally, downloading CSE reports can provide you with insights into the overall health of the Canadian securities market, as well as emerging trends and opportunities. This information can be especially useful for traders and investors looking to make strategic decisions about their portfolios.</p>
<p>In summary, downloading reports from the CSE exchange can provide valuable information for market participants and</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">cad_tickers.exchanges.cse</span> <span class="kn">import</span> <span class="n">get_recent_docs_from_url</span>
<span class="kn">from</span> <span class="nn">extract_doc</span> <span class="kn">import</span> <span class="n">mk_dir</span><span class="p">,</span> <span class="n">handle_logic</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span><span class="p">,</span> <span class="n">StringIO</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">1. Get the list of documents from the CSE website</span>
<span class="sd">2. For each document, get the document url</span>
<span class="sd">3. If the document url is not in the csv file, add it to the csv file</span>
<span class="sd">4. For each document url, download the document and add it to the docs folder</span>
<span class="sd">5. For each document url, make a discord request with the document url</span>
<span class="sd">6. For each document url, make a discord request with the document summary</span>
<span class="sd">&quot;&quot;&quot;</span>


<span class="k">def</span> <span class="nf">fig_to_buffer</span><span class="p">(</span><span class="n">fig</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot; returns a matplotlib figure as a buffer</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">buf</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>
  <span class="n">buf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">imgdata</span> <span class="o">=</span> <span class="n">buf</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
  <span class="k">return</span> <span class="n">imgdata</span>

<span class="k">def</span> <span class="nf">make_discord_request</span><span class="p">(</span><span class="n">content</span><span class="p">,</span> <span class="n">embeds</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">file</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s2">&quot;DISCORD_WEBHOOK&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">url</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DISCORD_WEBHOOK Missing&#39;</span><span class="p">)</span>
        <span class="k">pass</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">data</span><span class="p">[</span><span class="s2">&quot;content&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">content</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="s1">&#39;application/pdf&#39;</span><span class="p">)}</span>
    <span class="k">if</span> <span class="n">filename</span> <span class="o">!=</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">file</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">files</span><span class="o">=</span><span class="n">files</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">embeds</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s2">&quot;embeds&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">embeds</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span><span class="p">}</span>
        <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">resp</span><span class="p">)</span> 
</pre></div>
</div>
<p>This code is a Python script that downloads documents from the Canadian Securities Exchange (CSE) website and makes a Discord request with the document URL and summary. Here’s a brief overview of what it does:</p>
<ol class="arabic simple">
<li><p>It retrieves a list of documents from the CSE website using the <code class="docutils literal notranslate"><span class="pre">get_recent_docs_from_url</span></code> function.</p></li>
<li><p>For each document, it retrieves the document URL.</p></li>
<li><p>If the document URL is not already in a CSV file, it adds it to the CSV file.</p></li>
<li><p>It downloads the document and saves it to a directory called <code class="docutils literal notranslate"><span class="pre">docs</span></code>.</p></li>
<li><p>For each document URL, it makes a Discord request with the document URL.</p></li>
<li><p>For each document URL, it makes another Discord request with the document summary.</p></li>
</ol>
<p>The Discord request is sent using the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library. The <code class="docutils literal notranslate"><span class="pre">make_discord_request</span></code> function takes in several arguments, including the content, embeds, filename, and file data. If the filename and file data are provided, the function makes a request with the file attached. If the embeds argument is provided, the function makes a request with the embeds data. The URL for the Discord webhook is read from an environment variable <code class="docutils literal notranslate"><span class="pre">DISCORD_WEBHOOK</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> 
<span class="n">stockList</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;PKK&quot;</span><span class="p">,</span> <span class="s2">&quot;IDK&quot;</span><span class="p">,</span> <span class="s2">&quot;ADDC&quot;</span><span class="p">,</span> <span class="s2">&quot;VPH&quot;</span><span class="p">,</span> <span class="s2">&quot;VST&quot;</span><span class="p">,</span> <span class="s2">&quot;ACT&quot;</span><span class="p">]</span>
<span class="k">def</span> <span class="nf">get_cse_tickers_data</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://github.com/FriendlyUser/cad_tickers_list/blob/main/static/latest/cse.csv?raw=true&quot;</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">content</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)))</span>

<span class="n">stock_df</span> <span class="o">=</span> <span class="n">get_cse_tickers_data</span><span class="p">()</span>
<span class="n">stock_rows</span> <span class="o">=</span> <span class="n">stock_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">stock_df</span><span class="p">[</span><span class="s1">&#39;Symbol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">stockList</span><span class="p">)]</span>
<span class="n">stock_rows</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;stock&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stock_rows</span><span class="p">[</span><span class="s1">&#39;Symbol&#39;</span><span class="p">]</span>
<span class="n">stock_rows</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;url&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">stock_rows</span><span class="p">[</span><span class="s1">&#39;urls&#39;</span><span class="p">]</span>
<span class="n">stockUrls</span> <span class="o">=</span> <span class="n">stock_rows</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
<span class="n">csv_file</span> <span class="o">=</span> <span class="s2">&quot;docs.csv&quot;</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">csv_file</span><span class="p">):</span>
    <span class="c1"># read from csv</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># make new df</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;stock&quot;</span><span class="p">,</span> <span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;docUrl&quot;</span><span class="p">])</span>
 
</pre></div>
</div>
<p>This code is retrieving data for a list of stocks (<code class="docutils literal notranslate"><span class="pre">stockList</span></code>) from the Canadian Securities Exchange (CSE). It uses the <code class="docutils literal notranslate"><span class="pre">get_cse_tickers_data</span></code> function to retrieve the data from a CSV file hosted on GitHub, which contains information about CSE stocks, such as their symbol, name, and URLs. The function uses the <code class="docutils literal notranslate"><span class="pre">requests</span></code> library to make a GET request to the URL of the CSV file, and the returned content is then converted into a Pandas DataFrame using <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code>.</p>
<p>Next, the code filters the data for only the stocks in the <code class="docutils literal notranslate"><span class="pre">stockList</span></code> by using the <code class="docutils literal notranslate"><span class="pre">loc</span></code> method on the DataFrame and checking if the value in the <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> column is in the <code class="docutils literal notranslate"><span class="pre">stockList</span></code> using the <code class="docutils literal notranslate"><span class="pre">isin</span></code> method. The filtered data is then saved in the <code class="docutils literal notranslate"><span class="pre">stock_rows</span></code> DataFrame.</p>
<p>The code then creates two new columns in the <code class="docutils literal notranslate"><span class="pre">stock_rows</span></code> DataFrame, one named <code class="docutils literal notranslate"><span class="pre">stock</span></code> and the other named <code class="docutils literal notranslate"><span class="pre">url</span></code>, which contain the values from the <code class="docutils literal notranslate"><span class="pre">Symbol</span></code> and <code class="docutils literal notranslate"><span class="pre">urls</span></code> columns, respectively. The filtered data is then converted into a list of dictionaries (<code class="docutils literal notranslate"><span class="pre">stockUrls</span></code>) using the <code class="docutils literal notranslate"><span class="pre">to_dict</span></code> method.</p>
<p>Finally, the code checks if there is an existing CSV file named <code class="docutils literal notranslate"><span class="pre">docs.csv</span></code> in the current directory. If there is, it reads the data into a DataFrame using `pd.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="k">for</span> <span class="n">stock</span> <span class="ow">in</span> <span class="n">stockUrls</span><span class="p">:</span>
    <span class="n">stockName</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;stock&quot;</span><span class="p">)</span>
    <span class="n">stockUrl</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">)</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">urls</span> <span class="o">=</span> <span class="n">get_recent_docs_from_url</span><span class="p">(</span><span class="n">stockUrl</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">pass</span>
    
    <span class="k">for</span> <span class="n">docUrl</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
        <span class="c1"># skip malformed relative urls</span>
        <span class="k">if</span> <span class="n">docUrl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="c1"># add each element to list</span>
        <span class="n">exists</span> <span class="o">=</span> <span class="n">docUrl</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;docUrl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">exists</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Adding </span><span class="si">{</span><span class="n">stockName</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">docUrl</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)]</span> <span class="o">=</span> <span class="p">[</span><span class="n">stockName</span><span class="p">,</span> <span class="n">stockUrl</span><span class="p">,</span> <span class="n">docUrl</span><span class="p">]</span>
            <span class="c1"># wrap in todo</span>
            <span class="n">stock_doc_dir</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;docs/</span><span class="si">{</span><span class="n">stockName</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">mk_dir</span><span class="p">(</span><span class="n">stock_doc_dir</span><span class="p">)</span>
            <span class="n">stock_doc_file_path</span> <span class="o">=</span> <span class="n">docUrl</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">pdf_file_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">stock_doc_dir</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">stock_doc_file_path</span><span class="si">}</span><span class="s2">.pdf&quot;</span>
            <span class="n">companyName</span> <span class="o">=</span> <span class="n">stock</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Company&quot;</span><span class="p">)</span><span class="o">.</span>\
                <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Inc.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span>\
                <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Pharma&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span>\
                <span class="n">strip</span><span class="p">()</span>
            <span class="n">dataDict</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">docUrl</span><span class="p">,</span>
                <span class="s2">&quot;path&quot;</span><span class="p">:</span> <span class="n">pdf_file_name</span><span class="p">,</span>
                <span class="s2">&quot;company_name&quot;</span><span class="p">:</span> <span class="n">companyName</span>
            <span class="p">}</span>
            <span class="n">result_obj</span> <span class="o">=</span> <span class="n">handle_logic</span><span class="p">(</span><span class="n">dataDict</span><span class="p">)</span>
            <span class="n">file_contents</span> <span class="o">=</span> <span class="n">result_obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;contents&quot;</span><span class="p">)</span>
            <span class="n">summary</span> <span class="o">=</span> <span class="s2">&quot;N/A&quot;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">summary</span> <span class="o">=</span> <span class="n">result_obj</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;summary&quot;</span><span class="p">)[:</span><span class="mi">1980</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="n">embeds</span> <span class="o">=</span> <span class="p">[</span>
                <span class="p">{</span>
                    <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="n">stockName</span><span class="p">,</span>
                    <span class="s2">&quot;url&quot;</span><span class="p">:</span> <span class="n">docUrl</span><span class="p">,</span>
                    <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="n">summary</span>
                <span class="p">}</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="n">file_contents</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">make_discord_request</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*</span><span class="si">{</span><span class="n">stockName</span><span class="si">}</span><span class="s2">*: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">docUrl</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">embeds</span><span class="p">,</span> <span class="n">pdf_file_name</span><span class="p">,</span> <span class="n">file_contents</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">make_discord_request</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;*</span><span class="si">{</span><span class="n">stockName</span><span class="si">}</span><span class="s2">*: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">docUrl</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">embeds</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">pass</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stock&#39;</span><span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
</pre></div>
</div>
<p>This code is a script that downloads and summarizes recent documents from a list of stock symbols. The stock symbols are stored in the list <code class="docutils literal notranslate"><span class="pre">stockList</span></code>, and the data for these symbols is obtained by calling the <code class="docutils literal notranslate"><span class="pre">get_cse_tickers_data</span></code> function, which retrieves data from a CSV file stored on GitHub.</p>
<p>The code then loops through each of the stocks in <code class="docutils literal notranslate"><span class="pre">stockList</span></code>, and for each stock, it retrieves a list of recent documents by calling the <code class="docutils literal notranslate"><span class="pre">get_recent_docs_from_url</span></code> function and passing it the URL for the stock.</p>
<p>For each document, the code checks if the document URL already exists in the DataFrame <code class="docutils literal notranslate"><span class="pre">df</span></code>. If the URL does not exist, the code adds the document information (i.e., stock name, URL, and a summary) to <code class="docutils literal notranslate"><span class="pre">df</span></code> and makes a Discord request to post the information to a Discord channel. The information posted to the Discord channel includes the stock name, document URL, and a summary of the document’s contents. If the contents of the document are available, they are also included in the Discord request as an attachment.</p>
<p>After all the documents have been processed, the code removes any duplicates in <code class="docutils literal notranslate"><span class="pre">df</span></code> and sorts the entries by the stock name. Finally, the updated <code class="docutils literal notranslate"><span class="pre">df</span></code> is saved to a CSV file.</p>
<section id="id2">
<h3>References<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="github reference external" href="https://github.com/dli-invest/cse_file_downloader/blob/main/scrap_cse_releases.py">dli-invest/cse_file_downloader</a></p></li>
</ul>
</section>
</section>
<section id="generate-subtitles-for-youtube-videos">
<h2>Generate Subtitles for Youtube Videos<a class="headerlink" href="#generate-subtitles-for-youtube-videos" title="Permalink to this heading">#</a></h2>
<p>Transcribing videos is important for several reasons. Firstly, it makes the content of the video more accessible to people who are deaf or hard of hearing. Secondly, it can improve search engine optimization (SEO) as the text in the transcription can be indexed by search engines. Thirdly, it can make it easier to create captions or subtitles for the video, which can again make it more accessible to a wider audience. Finally, transcribing videos can be useful for researchers or content creators who want to analyze the content of the video or repurpose it in other ways.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">whisper</span>
<span class="kn">import</span> <span class="nn">gradio</span> <span class="k">as</span> <span class="nn">gr</span>
<span class="kn">import</span> <span class="nn">ffmpeg</span>
<span class="kn">from</span> <span class="nn">yt_dlp</span> <span class="kn">import</span> <span class="n">YoutubeDL</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">subprocess</span> <span class="kn">import</span> <span class="n">PIPE</span><span class="p">,</span> <span class="n">run</span>

<span class="n">youtube_livestream_codes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">91</span><span class="p">,</span>
    <span class="mi">92</span><span class="p">,</span>
    <span class="mi">93</span><span class="p">,</span>
    <span class="mi">94</span><span class="p">,</span>
    <span class="mi">95</span><span class="p">,</span>
    <span class="mi">96</span><span class="p">,</span>
    <span class="mi">300</span><span class="p">,</span>
    <span class="mi">301</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">youtube_mp4_codes</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">298</span><span class="p">,</span>
    <span class="mi">18</span><span class="p">,</span>
    <span class="mi">22</span><span class="p">,</span>
    <span class="mi">140</span><span class="p">,</span>
    <span class="mi">133</span><span class="p">,</span>
    <span class="mi">134</span>
<span class="p">]</span>

<span class="k">def</span> <span class="nf">second_to_timecode</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">hour</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">3600</span><span class="p">)</span>
    <span class="n">minute</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
    <span class="n">second</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">millisecond</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="mf">1000.</span><span class="p">)</span>

    <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%.2d</span><span class="s1">:</span><span class="si">%.2d</span><span class="s1">:</span><span class="si">%.2d</span><span class="s1">,</span><span class="si">%.3d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">hour</span><span class="p">,</span> <span class="n">minute</span><span class="p">,</span> <span class="n">second</span><span class="p">,</span> <span class="n">millisecond</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_video_metadata</span><span class="p">(</span><span class="n">video_url</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;https://www.youtube.com/watch?v=21X5lGlDOfg&amp;ab_channel=NASA&quot;</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">YoutubeDL</span><span class="p">({</span><span class="s1">&#39;outtmpl&#39;</span><span class="p">:</span> <span class="s1">&#39;</span><span class="si">%(id)s</span><span class="s1">.</span><span class="si">%(ext)s</span><span class="s1">&#39;</span><span class="p">})</span> <span class="k">as</span> <span class="n">ydl</span><span class="p">:</span>
        <span class="n">info_dict</span> <span class="o">=</span> <span class="n">ydl</span><span class="o">.</span><span class="n">extract_info</span><span class="p">(</span><span class="n">video_url</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">video_title</span> <span class="o">=</span> <span class="n">info_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">uploader_id</span> <span class="o">=</span> <span class="n">info_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;uploader_id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[youtube] </span><span class="si">{</span><span class="n">video_title</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">uploader_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">info_dict</span>


<span class="k">def</span> <span class="nf">parse_metadata</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parse metadata and send to discord.</span>
<span class="sd">    After a video is done recording, </span>
<span class="sd">    it will have both the livestream format and the mp4 format.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># send metadata to discord</span>
    <span class="n">formats</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;formats&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="c1"># filter for ext = mp4</span>
    <span class="n">mp4_formats</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">formats</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ext&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;mp4&quot;</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">format_ids</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format_id&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">mp4_formats</span><span class="p">]</span>
        <span class="n">video_entries</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">format_ids</span><span class="p">)</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">youtube_mp4_codes</span><span class="p">))</span>

        <span class="n">is_livestream</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">video_entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># use video format id over livestream id if available</span>
            <span class="n">selected_id</span> <span class="o">=</span> <span class="n">video_entries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">is_livestream</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">selected_id</span> <span class="o">=</span> <span class="n">mp4_formats</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format_id&quot;</span><span class="p">)</span>
        <span class="n">is_livestream</span> <span class="o">=</span> <span class="kc">False</span>


    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;selected_id&quot;</span><span class="p">:</span> <span class="n">selected_id</span><span class="p">,</span>
        <span class="s2">&quot;is_livestream&quot;</span><span class="p">:</span> <span class="n">is_livestream</span><span class="p">,</span>
    <span class="p">}</span> 
</pre></div>
</div>
<p>The above code is written in Python and contains functions for getting metadata for a YouTube video, parsing the metadata, and converting seconds to timecode. It also imports the necessary libraries including <code class="docutils literal notranslate"><span class="pre">whisper</span></code>, <code class="docutils literal notranslate"><span class="pre">gradio</span></code>, <code class="docutils literal notranslate"><span class="pre">ffmpeg</span></code>, <code class="docutils literal notranslate"><span class="pre">yt_dlp</span></code>, <code class="docutils literal notranslate"><span class="pre">os</span></code>, <code class="docutils literal notranslate"><span class="pre">sys</span></code>, and <code class="docutils literal notranslate"><span class="pre">subprocess</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">get_video_metadata</span></code> function takes a YouTube video URL as input and returns a dictionary containing metadata about the video such as the title and uploader ID. This function uses the <code class="docutils literal notranslate"><span class="pre">YoutubeDL</span></code> library to extract information about the video from YouTube.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">parse_metadata</span></code> function takes the metadata dictionary as input and returns a dictionary containing the selected video format ID and a boolean indicating whether the video is a livestream or not. This function filters the available video formats to only include MP4 formats and then selects the video format with the highest priority (based on the priority list <code class="docutils literal notranslate"><span class="pre">youtube_mp4_codes</span></code>). If no MP4 format is available, it selects the first available format.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">second_to_timecode</span></code> function takes a floating-point number representing a time in seconds as input and returns a string formatted as <code class="docutils literal notranslate"><span class="pre">hh:mm:ss,ms</span></code> (hours:minutes:seconds,milliseconds) where <code class="docutils literal notranslate"><span class="pre">ms</span></code> is the milliseconds portion of the time.</p>
<p>Note that the code also includes a list of YouTube format codes for livestreams (<code class="docutils literal notranslate"><span class="pre">youtube_livestream_codes</span></code>) and MP4 formats (<code class="docutils literal notranslate"><span class="pre">youtube_mp4_codes</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="k">def</span> <span class="nf">get_video</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get video from start time.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># result = subprocess.run()</span>
    <span class="c1"># could delay start time by a few seconds to just sync up and capture the full video length</span>
    <span class="c1"># but would need to time how long it takes to fetch the video using youtube-dl and other adjustments and start a bit before</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;filename&quot;</span><span class="p">,</span> <span class="s2">&quot;livestream01.mp4&quot;</span><span class="p">)</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s2">&quot;00:15:00&quot;</span><span class="p">)</span>
    <span class="n">overlay_file</span> <span class="o">=</span> <span class="n">ffmpeg</span><span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="p">(</span>
        <span class="n">ffmpeg</span>
        <span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">end</span><span class="p">)</span>
        <span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="o">.</span><span class="n">run</span><span class="p">()</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">get_all_files</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;00:15:00&quot;</span><span class="p">):</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">get_video_metadata</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">temp_dict</span> <span class="o">=</span> <span class="n">parse_metadata</span><span class="p">(</span><span class="n">metadata</span><span class="p">)</span>
    <span class="n">selected_id</span> <span class="o">=</span> <span class="n">temp_dict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;selected_id&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">formats</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;formats&quot;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="n">selected_format</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">formats</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;format_id&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">selected_id</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">format_url</span> <span class="o">=</span> <span class="n">selected_format</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="s2">&quot;temp.mp4&quot;</span>
    <span class="n">get_video</span><span class="p">(</span><span class="n">format_url</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;filename&quot;</span><span class="p">:</span> <span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">:</span> <span class="n">end</span><span class="p">})</span>
    <span class="k">return</span> <span class="n">filename</span>

<span class="k">def</span> <span class="nf">get_text_from_mp3_whisper</span><span class="p">(</span><span class="n">inputType</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">mp3_file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">url_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">taskName</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">srcLanguage</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">str</span><span class="p">:</span>
    <span class="c1"># remove the file if it exists</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;transcript.srt&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;transcript.srt&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;temp.mp4&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;temp.mp4&quot;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s2">&quot;subtitled.mp4&quot;</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;subtitled.mp4&quot;</span><span class="p">)</span>
    
    <span class="n">model</span> <span class="o">=</span> <span class="n">whisper</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="s2">&quot;medium&quot;</span><span class="p">)</span>
    <span class="c1"># options = whisper.DecodingOptions(language=&quot;en&quot;, without_timestamps=True)</span>
    <span class="n">options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="n">srcLanguage</span><span class="p">)</span>
    <span class="n">transcribe_options</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">task</span><span class="o">=</span><span class="n">taskName</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
    <span class="c1"># return if url_path is not set, taskName is not set, srcLanguage is not set</span>
    <span class="k">if</span> <span class="n">inputType</span> <span class="o">==</span> <span class="s2">&quot;url&quot;</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="n">get_all_files</span><span class="p">(</span><span class="n">url_path</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Retrieved the file&quot;</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transcribe</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="o">**</span><span class="n">transcribe_options</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;transcribing the file&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">transcribe</span><span class="p">(</span><span class="n">mp3_file</span><span class="p">,</span> <span class="o">**</span><span class="n">transcribe_options</span><span class="p">)</span>
    <span class="c1"># adjust for spacy mode</span>
    <span class="n">html_text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">count</span><span class="p">,</span> <span class="n">segment</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;segments&quot;</span><span class="p">)):</span>
        <span class="c1"># print(segment)</span>
        <span class="n">start</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">)</span>
        <span class="n">end</span> <span class="o">=</span> <span class="n">segment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">count</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">second_to_timecode</span><span class="p">(</span><span class="n">start</span><span class="p">)</span><span class="si">}</span><span class="s2"> --&gt; </span><span class="si">{</span><span class="n">second_to_timecode</span><span class="p">(</span><span class="n">end</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">segment</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="n">words</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span>
    <span class="c1"># save to transcript.srt</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;transcript.srt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;done transcribing&quot;</span><span class="p">)</span>

    <span class="n">input_file</span> <span class="o">=</span> <span class="s1">&#39;temp.mp4&#39;</span>
    <span class="n">subtitles_file</span> <span class="o">=</span> <span class="s1">&#39;transcript.srt&#39;</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;subtitled.mp4&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;attempt to output file&quot;</span><span class="p">)</span>
        <span class="p">(</span>
            <span class="n">ffmpeg</span>
            <span class="o">.</span><span class="n">input</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
            <span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="s1">&#39;subtitles&#39;</span><span class="p">,</span> <span class="n">subtitles_file</span><span class="p">)</span>
            <span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
            <span class="o">.</span><span class="n">run</span><span class="p">()</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;failed to output file&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="n">output_file</span> <span class="o">=</span> <span class="s2">&quot;temp.mp4&quot;</span>
    <span class="c1"># return temp.mp4</span>
    
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;segments&quot;</span><span class="p">),</span> <span class="n">words</span><span class="p">,</span> <span class="n">output_file</span> 
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">get_text_from_mp3_whisper</span></code> function takes several arguments including <code class="docutils literal notranslate"><span class="pre">inputType</span></code>, <code class="docutils literal notranslate"><span class="pre">mp3_file</span></code>, <code class="docutils literal notranslate"><span class="pre">url_path</span></code>, <code class="docutils literal notranslate"><span class="pre">taskName</span></code>, and <code class="docutils literal notranslate"><span class="pre">srcLanguage</span></code>. It first removes any existing files with names <code class="docutils literal notranslate"><span class="pre">transcript.srt</span></code>, <code class="docutils literal notranslate"><span class="pre">temp.mp4</span></code>, and <code class="docutils literal notranslate"><span class="pre">subtitled.mp4</span></code>.</p>
<p>It then loads a pre-trained model from <code class="docutils literal notranslate"><span class="pre">whisper</span></code> using the <code class="docutils literal notranslate"><span class="pre">load_model</span></code> function. The function checks the value of <code class="docutils literal notranslate"><span class="pre">inputType</span></code> to determine whether to transcribe a local mp3 file (<code class="docutils literal notranslate"><span class="pre">mp3_file</span></code>) or a video at a remote URL (<code class="docutils literal notranslate"><span class="pre">url_path</span></code>). If <code class="docutils literal notranslate"><span class="pre">inputType</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;url&quot;</span></code>, it downloads the video from the remote URL using the <code class="docutils literal notranslate"><span class="pre">get_all_files</span></code> function and transcribes it. If <code class="docutils literal notranslate"><span class="pre">inputType</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;file&quot;</span></code>, it transcribes the local mp3 file.</p>
<p>The transcribed segments are then saved to a file named <code class="docutils literal notranslate"><span class="pre">transcript.srt</span></code>. The function then attempts to add subtitles to the video by overlaying the saved SRT file onto a copy of the video file. The resulting file is saved as <code class="docutils literal notranslate"><span class="pre">subtitled.mp4</span></code>. If the overlaying process fails, it saves the resulting file as <code class="docutils literal notranslate"><span class="pre">temp.mp4</span></code>.</p>
<p>The function then returns the segments and the contents of the SRT file as a string, as well as the name of the resulting video file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">gr</span><span class="o">.</span><span class="n">Interface</span><span class="p">(</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Download Video From url and extract text from audio&#39;</span><span class="p">,</span> 
    <span class="n">fn</span><span class="o">=</span><span class="n">get_text_from_mp3_whisper</span><span class="p">,</span> 
    <span class="n">inputs</span><span class="o">=</span><span class="p">[</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">([</span><span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;url&quot;</span><span class="p">),</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">Audio</span><span class="p">(</span><span class="nb">type</span><span class="o">=</span><span class="s2">&quot;filepath&quot;</span><span class="p">),</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">Textbox</span><span class="p">(),</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">([</span><span class="s2">&quot;translate&quot;</span><span class="p">,</span> <span class="s2">&quot;transcribe&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;translate&quot;</span><span class="p">),</span>
        <span class="n">gr</span><span class="o">.</span><span class="n">Dropdown</span><span class="p">([</span><span class="s2">&quot;Japanese&quot;</span><span class="p">,</span> <span class="s2">&quot;English&quot;</span><span class="p">],</span> <span class="n">value</span><span class="o">=</span><span class="s2">&quot;Japanese&quot;</span><span class="p">)</span>
    <span class="p">],</span>
    <span class="n">button_text</span><span class="o">=</span><span class="s2">&quot;Go!&quot;</span><span class="p">,</span>
    <span class="n">button_color</span><span class="o">=</span><span class="s2">&quot;#333333&quot;</span><span class="p">,</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;json&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="s2">&quot;file&quot;</span>
    <span class="p">],</span> 
</pre></div>
</div>
<p>It seems that the code block is not complete, as there is no closing parenthesis for the <code class="docutils literal notranslate"><span class="pre">gr.Interface</span></code> function call. However, assuming that the rest of the code is present, this function call creates a user interface using the <code class="docutils literal notranslate"><span class="pre">gradio</span></code> library.</p>
<p>The interface has a title, “Download Video From url and extract text from audio”, and it takes in the following inputs:</p>
<ol class="arabic simple">
<li><p>A dropdown menu to select the input type (“url” or “file”).</p></li>
<li><p>An audio input to upload an audio file.</p></li>
<li><p>A textbox to enter the URL of a video.</p></li>
<li><p>A dropdown menu to select the task (“translate” or “transcribe”).</p></li>
<li><p>A dropdown menu to select the source language (“Japanese” or “English”).</p></li>
</ol>
<p>The interface also has a button with text “Go!” and color “#333333”, and it outputs a JSON object, a string of text, and a file.</p>
<p>Using AI to transcribe videos has many practical benefits. Firstly, it enables the creation of accurate, searchable and accessible transcripts that can be used for a variety of purposes. Transcripts can be used to help people with hearing impairments to understand video content, as well as to provide captions and subtitles for non-native speakers of the video’s language. Transcripts can also be used to provide metadata for video content, making it easier to search and categorize. Additionally, transcripts can be used to analyze the content of video content, allowing for more effective search and retrieval of relevant information.</p>
<p>AI-based transcription is also faster and more cost-effective than traditional human transcription methods. With the advances in AI technology, transcription can be done much faster and at a lower cost than hiring human transcribers. This allows for more content to be transcribed in a shorter amount of time, and at a lower cost. Furthermore, AI-based transcription can be easily scaled up or down depending on the size of the content that needs to be transcribed.</p>
<p>Overall, using AI to transcribe videos is a useful and practical application of AI technology that has the potential to significantly improve the accessibility and usability of video content.</p>
<section id="id3">
<h3>References<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="https://huggingface.co/spaces/FriendlyUser/YoutubeDownloaderSubber">https://huggingface.co/spaces/FriendlyUser/YoutubeDownloaderSubber</a></p></li>
</ul>
</section>
</section>
<section id="scrapping-superbowl-results-with-pandas">
<h2>Scrapping Superbowl results with pandas<a class="headerlink" href="#scrapping-superbowl-results-with-pandas" title="Permalink to this heading">#</a></h2>
<p>The Super Bowl is the championship game of the National Football League (NFL), which is played annually to determine the winner of the NFL season. The game is played on the first Sunday in February and is considered the biggest sporting event in the United States, attracting millions of viewers each year. The Super Bowl is also one of the largest events in the world of advertising, with many of the most expensive and highly-anticipated commercials airing during the broadcast. In addition to the game itself, the Super Bowl weekend has become a major cultural event, with parties, concerts, and other festivities taking place in the host city leading up to the game.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>


<span class="c1"># read pandas dataframe from url</span>

<span class="n">base_url</span> <span class="o">=</span> <span class="s1">&#39;http://www.espn.com/nfl/history&#39;</span>
<span class="n">leaders_df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">/leaders&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;tablehead&#39;</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>


<span class="n">winners_df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;http://www.espn.com/nfl/superbowl/history/winners&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;tablehead&#39;</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>


<span class="n">mvp_df</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="s2">&quot;http://www.espn.com/nfl/superbowl/history/mvps&quot;</span><span class="p">,</span> <span class="n">attrs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;tablehead&#39;</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="n">leaders_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">winners_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mvp_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span> 
</pre></div>
</div>
<p>This code uses the <code class="docutils literal notranslate"><span class="pre">requests</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas</span></code>, and <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> libraries to retrieve and process data from three different URLs related to NFL history and the Super Bowl.</p>
<p>The first URL is for NFL leaders and the data is loaded into a pandas DataFrame called <code class="docutils literal notranslate"><span class="pre">leaders_df</span></code>. The second URL is for Super Bowl winners and the data is loaded into a pandas DataFrame called <code class="docutils literal notranslate"><span class="pre">winners_df</span></code>. The third URL is for Super Bowl MVPs and the data is loaded into a pandas DataFrame called <code class="docutils literal notranslate"><span class="pre">mvp_df</span></code>.</p>
<p>Finally, the code prints the first five rows of each DataFrame using the <code class="docutils literal notranslate"><span class="pre">head()</span></code> method of pandas DataFrames, which returns the first n (in this case, n=5) rows of the DataFrame.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>                    <span class="mi">0</span>                    <span class="mi">1</span>                  <span class="mi">2</span>
<span class="mi">0</span>  <span class="n">Touchdown</span> <span class="n">Leaders</span>    <span class="n">Touchdown</span> <span class="n">Leaders</span>  <span class="n">Touchdown</span> <span class="n">Leaders</span>
<span class="mi">1</span>                 <span class="n">RK</span>               <span class="n">PLAYER</span>                 <span class="n">TD</span>
<span class="mi">2</span>                  <span class="mi">1</span>           <span class="n">Jerry</span> <span class="n">Rice</span>                <span class="mi">208</span>
<span class="mi">3</span>                  <span class="mi">2</span>         <span class="n">Emmitt</span> <span class="n">Smith</span>                <span class="mi">175</span>
<span class="mi">4</span>                  <span class="mi">3</span>  <span class="n">LaDainian</span> <span class="n">Tomlinson</span>                <span class="mi">162</span>
                                <span class="mi">0</span>  <span class="o">...</span>                               <span class="mi">3</span>
<span class="mi">0</span>  <span class="n">Super</span> <span class="n">Bowl</span> <span class="n">Winners</span> <span class="ow">and</span> <span class="n">Results</span>  <span class="o">...</span>  <span class="n">Super</span> <span class="n">Bowl</span> <span class="n">Winners</span> <span class="ow">and</span> <span class="n">Results</span>
<span class="mi">1</span>                             <span class="n">NO</span><span class="o">.</span>  <span class="o">...</span>                          <span class="n">RESULT</span>
<span class="mi">2</span>                               <span class="n">I</span>  <span class="o">...</span>    <span class="n">Green</span> <span class="n">Bay</span> <span class="mi">35</span><span class="p">,</span> <span class="n">Kansas</span> <span class="n">City</span> <span class="mi">10</span>
<span class="mi">3</span>                              <span class="n">II</span>  <span class="o">...</span>        <span class="n">Green</span> <span class="n">Bay</span> <span class="mi">33</span><span class="p">,</span> <span class="n">Oakland</span> <span class="mi">14</span>
<span class="mi">4</span>                             <span class="n">III</span>  <span class="o">...</span>   <span class="n">New</span> <span class="n">York</span> <span class="n">Jets</span> <span class="mi">16</span><span class="p">,</span> <span class="n">Baltimore</span> <span class="mi">7</span>

<span class="p">[</span><span class="mi">5</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">4</span> <span class="n">columns</span><span class="p">]</span>
                                  <span class="mi">0</span>  <span class="o">...</span>                                 <span class="mi">2</span>
<span class="mi">0</span>  <span class="n">Super</span> <span class="n">Bowl</span> <span class="n">Most</span> <span class="n">Valuable</span> <span class="n">Players</span>  <span class="o">...</span>  <span class="n">Super</span> <span class="n">Bowl</span> <span class="n">Most</span> <span class="n">Valuable</span> <span class="n">Players</span>
<span class="mi">1</span>                               <span class="n">NO</span><span class="o">.</span>  <span class="o">...</span>                        <span class="n">HIGHLIGHTS</span>
<span class="mi">2</span>                                 <span class="n">I</span>  <span class="o">...</span>              <span class="n">Two</span> <span class="n">touchdown</span> <span class="n">passes</span>
<span class="mi">3</span>                                <span class="n">II</span>  <span class="o">...</span>           <span class="mi">202</span> <span class="n">yards</span> <span class="n">passing</span><span class="p">,</span> <span class="mi">1</span> <span class="n">TD</span>
<span class="mi">4</span>                               <span class="n">III</span>  <span class="o">...</span>                 <span class="mi">206</span> <span class="n">yards</span> <span class="n">passing</span> 
</pre></div>
</div>
<p>These are the first five rows of each of the three pandas DataFrames that were created from the URLs related to NFL history and the Super Bowl.</p>
<p>The first DataFrame, <code class="docutils literal notranslate"><span class="pre">leaders_df</span></code>, shows the NFL touchdown leaders, including the rank, player name, and number of touchdowns scored.</p>
<p>The second DataFrame, <code class="docutils literal notranslate"><span class="pre">winners_df</span></code>, shows the results of each Super Bowl game, including the number of the Super Bowl, the winning team, and the result.</p>
<p>The third DataFrame, <code class="docutils literal notranslate"><span class="pre">mvp_df</span></code>, shows the most valuable player of each Super Bowl, including the number of the Super Bowl, the player’s name, and highlights of their performance.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="c1"># grab 4th column</span>
<span class="c1"># pandas drop first row of winners_df and change column names</span>
<span class="c1"># save winners_df to csv</span>
<span class="n">winners_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;winners_raw.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">winners_df</span> <span class="o">=</span> <span class="n">winners_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">winners_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">winners_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">winners_df</span> <span class="o">=</span> <span class="n">winners_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">winners_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">winners_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;winners.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">winners_df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">sites_of_superbowl</span> <span class="o">=</span> <span class="n">winners_df</span><span class="p">[</span><span class="s1">&#39;SITE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sites_of_superbowl</span><span class="p">)</span>
<span class="c1"># for date column find the number of instances of Orange Bowl and plot it</span>
<span class="c1"># adjust all site to drop content in () and save to csv</span>

<span class="n">winners_df_adjusted</span> <span class="o">=</span> <span class="n">winners_df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">winners_df_adjusted</span><span class="p">[</span><span class="s1">&#39;SITE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">winners_df_adjusted</span><span class="p">[</span><span class="s1">&#39;SITE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\(.*\)&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span>  <span class="n">winners_df_adjusted</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;SITE&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span><span class="o">.</span><span class="n">get_figure</span><span class="p">()</span> 
</pre></div>
</div>
<p>This code continues processing the <code class="docutils literal notranslate"><span class="pre">winners_df</span></code> DataFrame, which contains information about the results of each Super Bowl game.</p>
<p>The 4th column of <code class="docutils literal notranslate"><span class="pre">winners_df</span></code> is not grabbed because the code does not contain any specific instructions to do so.</p>
<p>The first row of <code class="docutils literal notranslate"><span class="pre">winners_df</span></code> is dropped using the <code class="docutils literal notranslate"><span class="pre">iloc</span></code> method and the remaining rows are set as the new column names using the <code class="docutils literal notranslate"><span class="pre">columns</span></code> attribute. This DataFrame is then saved to a new CSV file called ‘winners.csv’ using the <code class="docutils literal notranslate"><span class="pre">to_csv</span></code> method of pandas DataFrames.</p>
<p>Next, the code uses the <code class="docutils literal notranslate"><span class="pre">unique</span></code> method of pandas Series to get the unique values of the ‘SITE’ column and store the result in a variable called <code class="docutils literal notranslate"><span class="pre">sites_of_superbowl</span></code>.</p>
<p>Then, a new DataFrame called <code class="docutils literal notranslate"><span class="pre">winners_df_adjusted</span></code> is created as a copy of <code class="docutils literal notranslate"><span class="pre">winners_df</span></code> and the ‘SITE’ column is adjusted to remove the content in parentheses using the <code class="docutils literal notranslate"><span class="pre">str.replace</span></code> method of pandas Series.</p>
<p>Finally, the code uses the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method of pandas DataFrames to group the DataFrame by the ‘SITE’ column and the <code class="docutils literal notranslate"><span class="pre">size</span></code> method to get the size of each group. The resulting pandas Series is plotted using the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method with the <code class="docutils literal notranslate"><span class="pre">kind</span></code> argument set to ‘bar’ and the <code class="docutils literal notranslate"><span class="pre">figsize</span></code> argument set to (10, 18). The figure object is stored in a variable called <code class="docutils literal notranslate"><span class="pre">fig</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">Index</span><span class="p">([</span><span class="s1">&#39;NO.&#39;</span><span class="p">,</span> <span class="s1">&#39;DATE&#39;</span><span class="p">,</span> <span class="s1">&#39;SITE&#39;</span><span class="p">,</span> <span class="s1">&#39;RESULT&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">1</span>  <span class="n">NO</span><span class="o">.</span>  <span class="o">...</span>                         <span class="n">RESULT</span>
<span class="mi">2</span>    <span class="n">I</span>  <span class="o">...</span>   <span class="n">Green</span> <span class="n">Bay</span> <span class="mi">35</span><span class="p">,</span> <span class="n">Kansas</span> <span class="n">City</span> <span class="mi">10</span>
<span class="mi">3</span>   <span class="n">II</span>  <span class="o">...</span>       <span class="n">Green</span> <span class="n">Bay</span> <span class="mi">33</span><span class="p">,</span> <span class="n">Oakland</span> <span class="mi">14</span>
<span class="mi">4</span>  <span class="n">III</span>  <span class="o">...</span>  <span class="n">New</span> <span class="n">York</span> <span class="n">Jets</span> <span class="mi">16</span><span class="p">,</span> <span class="n">Baltimore</span> <span class="mi">7</span>
<span class="mi">5</span>   <span class="n">IV</span>  <span class="o">...</span>    <span class="n">Kansas</span> <span class="n">City</span> <span class="mi">23</span><span class="p">,</span> <span class="n">Minnesota</span> <span class="mi">7</span>
<span class="mi">6</span>    <span class="n">V</span>  <span class="o">...</span>        <span class="n">Baltimore</span> <span class="mi">16</span><span class="p">,</span> <span class="n">Dallas</span> <span class="mi">13</span>

<span class="p">[</span><span class="mi">5</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">4</span> <span class="n">columns</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;Los Angeles Memorial Coliseum&#39;</span> <span class="s1">&#39;Orange Bowl (Miami)&#39;</span>
 <span class="s1">&#39;Tulane Stadium (New Orleans)&#39;</span> <span class="s1">&#39;Rice Stadium (Houston)&#39;</span>
 <span class="s1">&#39;Rose Bowl (Pasadena, Calif.)&#39;</span> <span class="s1">&#39;Superdome (New Orleans)&#39;</span>
 <span class="s1">&#39;Silverdome (Pontiac, Mich.)&#39;</span> <span class="s1">&#39;Tampa (Fla.) Stadium&#39;</span>
 <span class="s1">&#39;Stanford (Calif.) Stadium&#39;</span> <span class="s1">&#39;Jack Murphy Stadium (San Diego)&#39;</span>
 <span class="s1">&#39;Joe Robbie Stadium (Miami)&#39;</span> <span class="s1">&#39;Metrodome (Minneapolis)&#39;</span>
 <span class="s1">&#39;Georgia Dome (Atlanta)&#39;</span> <span class="s1">&#39;Sun Devil Stadium (Tempe, Ariz.)&#39;</span>
 <span class="s1">&#39;Qualcomm Stadium (San Diego)&#39;</span> <span class="s1">&#39;Pro Player Stadium (Miami)&#39;</span>
 <span class="s1">&#39;Raymond James Stadium (Tampa, Fla.)&#39;</span> <span class="s1">&#39;Reliant Stadium (Houston)&#39;</span>
 <span class="s1">&#39;Alltel Stadium (Jacksonville, Fla.)&#39;</span> <span class="s1">&#39;Ford Field (Detroit)&#39;</span>
 <span class="s1">&#39;Dolphin Stadium (Miami)&#39;</span>
 <span class="s1">&#39;University of Phoenix Stadium (Glendale, Ariz.)&#39;</span>
 <span class="s1">&#39;Sun Life Stadium (Miami)&#39;</span> <span class="s1">&#39;Cowboys Stadium (Arlington, Texas)&#39;</span>
 <span class="s1">&#39;Lucas Oil Stadium (Indianapolis)&#39;</span>
 <span class="s1">&#39;Mercedes-Benz Superdome (New Orleans)&#39;</span>
 <span class="s1">&#39;MetLife Stadium (East Rutherford, N.J.)&#39;</span>
 <span class="s2">&quot;Levi&#39;s Stadium (Santa Clara, Calif.)&quot;</span> <span class="s1">&#39;NRG Stadium (Houston)&#39;</span>
 <span class="s1">&#39;U.S. Bank Stadium (Minneapolis)&#39;</span> <span class="s1">&#39;Mercedes-Benz Stadium (Atlanta)&#39;</span>
 <span class="s1">&#39;Hard Rock Stadium (Miami)&#39;</span> <span class="s1">&#39;SoFi Stadium (Inglewood, Calif.)&#39;</span> 
</pre></div>
</div>
<p>The code above uses the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library to scrape data about the NFL Super Bowl winners, MVPs, and touchdown leaders from the ESPN website. It then saves the data in CSV format for future use.</p>
<p>It starts by reading the HTML tables from the website using the <code class="docutils literal notranslate"><span class="pre">read_html</span></code> method from the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library and storing the results in dataframes. The first dataframe, <code class="docutils literal notranslate"><span class="pre">leaders_df</span></code>, contains the touchdown leaders. The second dataframe, <code class="docutils literal notranslate"><span class="pre">winners_df</span></code>, contains the Super Bowl winners and results. The third dataframe, <code class="docutils literal notranslate"><span class="pre">mvp_df</span></code>, contains the Super Bowl MVPs.</p>
<p>The code then processes the <code class="docutils literal notranslate"><span class="pre">winners_df</span></code> dataframe to remove the first row and set the column names, which are the first row of the dataframe. The processed dataframe is then saved in a new CSV file called ‘winners.csv’.</p>
<p>Next, the code extracts the unique values of the ‘SITE’ column of the <code class="docutils literal notranslate"><span class="pre">winners_df</span></code> dataframe and stores the results in the <code class="docutils literal notranslate"><span class="pre">sites_of_superbowl</span></code> array. The code then creates a new dataframe called <code class="docutils literal notranslate"><span class="pre">winners_df_adjusted</span></code> that is a copy of the <code class="docutils literal notranslate"><span class="pre">winners_df</span></code> dataframe but with the content in the parentheses removed from the ‘SITE’ column. Finally, the code plots a bar chart of the number of instances of each site using the <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> methods from the <code class="docutils literal notranslate"><span class="pre">pandas</span></code> library and the <code class="docutils literal notranslate"><span class="pre">plot</span></code> method from the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> library.</p>
<p><img alt="football graph" src="https://raw.githubusercontent.com/FriendlyUser/data-science-projects/main/superbowl/winners.png" />
Yes, indeed! Web scraping is a powerful tool to collect data from websites and the combination with data visualization makes it even more valuable to understand and draw insights from the data. It’s also a great way to automate data collection and analysis tasks.</p>
<section id="id4">
<h3>References<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="github reference external" href="https://github.com/FriendlyUser/data-science-projects/tree/main/superbowl">FriendlyUser/data-science-projects</a></p></li>
</ul>
</section>
</section>
<section id="getting-youtube-livestream-status">
<h2>Getting youtube livestream status<a class="headerlink" href="#getting-youtube-livestream-status" title="Permalink to this heading">#</a></h2>
<p>YouTube is a video-sharing website where users can upload, share, and view videos. It was founded in February 2005 and later acquired by Google in November 2006. It has since become one of the largest and most popular websites on the internet, offering a wide variety of content, including music videos, educational videos, movie trailers, and more. Users can also interact with each other by commenting on videos, giving “thumbs up” or “thumbs down” ratings, and subscribing to other users’ channels. YouTube is available on various devices, including computers, smartphones, and smart TVs.</p>
<p>Transcribing Federal Reserve livestreams in real time is important for investors because the statements made by Federal Reserve officials can have a significant impact on financial markets. The Federal Reserve is the central bank of the United States, and its policies and statements on monetary policy, economic conditions, and interest rates can have a major effect on the stock market, the bond market, and the value of the US dollar.</p>
<p>By transcribing the livestreams in real time, investors can quickly and accurately obtain information and insights from the Federal Reserve’s statements. This can help them make informed investment decisions and respond to market changes as they occur. Additionally, real-time transcription allows investors to more effectively analyze and interpret the Federal Reserve’s statements, giving them a competitive advantage in a fast-paced and constantly-changing market.</p>
<p>In short, transcribing Federal Reserve livestreams in real time is important for investors because it allows them to stay up-to-date on the central bank’s statements and respond quickly to market changes, which can have a significant impact on their investments.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">author: FriendlyUser</span>
<span class="sd">description: grab livestream data from url using selenium, (need a browser for youtube)</span>
<span class="sd">create database entries to track livestreams, check if livestream is live or upcoming and exclude certain channels with never ending livestreams.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">bs4</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">dateparser</span>

<span class="k">def</span> <span class="nf">get_livestreams_from_html</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gets livestream from html from youtube channel and determines if it is live or upcoming.</span>
<span class="sd">        Returns dict:</span>
<span class="sd">          time: time of livestream</span>
<span class="sd">          channel: channel name</span>
<span class="sd">          status: LIVE or UPCOMING or none</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get text data from url using requests</span>
    <span class="k">try</span><span class="p">:</span>

        <span class="n">soup</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;html.parser&quot;</span><span class="p">)</span>

        <span class="n">livestream_data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">first_section</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;ytd-item-section-renderer&quot;</span><span class="p">)</span>

        <span class="n">title_wrapper</span> <span class="o">=</span> <span class="n">first_section</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;ytd-channel-video-player-renderer&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">title_wrapper</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">watch_link</span> <span class="o">=</span> <span class="n">first_section</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;yt-simple-endpoint style-scope ytd-video-renderer&quot;</span><span class="p">})</span>
            <span class="n">watch_url</span> <span class="o">=</span> <span class="n">watch_link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">channel_title</span> <span class="o">=</span> <span class="n">title_wrapper</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;yt-formatted-string&quot;</span><span class="p">)</span>
            <span class="n">watch_link</span> <span class="o">=</span> <span class="n">channel_title</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
            <span class="n">watch_url</span> <span class="o">=</span> <span class="n">watch_link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">)</span>
        <span class="c1"># get video_id </span>
        <span class="n">ytd_thumbnail_overlay_time_status_renderer</span> <span class="o">=</span> <span class="n">first_section</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;ytd-thumbnail-overlay-time-status-renderer&quot;</span><span class="p">)</span>
        <span class="c1"># try to find ytd-video-renderer and get href</span>

        <span class="k">if</span> <span class="n">ytd_thumbnail_overlay_time_status_renderer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># try to grab upcoming livestream</span>
            <span class="n">scheduled_text</span> <span class="o">=</span> <span class="n">first_section</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;ytd-video-meta-block&quot;</span><span class="p">)</span>
            <span class="n">run_time</span> <span class="o">=</span> <span class="n">scheduled_text</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
            <span class="c1"># parse strings like August 22 at 6:00 AM</span>
            <span class="c1"># remove words like at</span>
            <span class="n">run_str</span> <span class="o">=</span> <span class="n">run_time</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Scheduled for&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">parsed_date</span> <span class="o">=</span>  <span class="n">dateparser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">run_str</span><span class="p">)</span>
            <span class="n">livestream_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="n">parsed_date</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;UPCOMING&quot;</span><span class="p">,</span> <span class="s2">&quot;watch_url&quot;</span><span class="p">:</span> <span class="n">watch_url</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">livestream_label</span> <span class="o">=</span> <span class="n">ytd_thumbnail_overlay_time_status_renderer</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">livestream_label</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">livestream_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="n">livestream_label</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="s2">&quot;watch_url&quot;</span><span class="p">:</span> <span class="n">watch_url</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">livestream_data</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error getting data from url&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span> 
</pre></div>
</div>
<p>This code uses the BeautifulSoup library and Selenium WebDriver to scrape a YouTube channel for live stream data. The function <code class="docutils literal notranslate"><span class="pre">get_livestreams_from_html</span></code> takes in an HTML string as input and returns a list of dictionaries, each representing a live stream event.</p>
<p>The function first creates a BeautifulSoup object from the input HTML string and then searches the HTML tree for specific elements that contain information about the live streams. It checks if the live stream is currently happening or if it’s scheduled to happen in the future, and if it’s live, it checks if it’s never ending. If the live stream is never ending, the function does not include that event in the list of live streams.</p>
<p>The function uses the dateparser library to parse dates from strings, such as “August 22 at 6:00 AM”. The live stream events are returned as a list of dictionaries, each containing the date and time of the event, the channel name, and the status of the event (live or upcoming).</p>
<p>This code can be used as a starting point for a more comprehensive script that scrapes live streams from YouTube, but it may need to be adapted to fit the specific needs of the user.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> 
<span class="k">def</span> <span class="nf">get_webdriver</span><span class="p">():</span>
    <span class="n">remote_url</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;REMOTE_SELENIUM_URL&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">remote_url</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Missing REMOTE_SELENIUM_URL in env vars&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Remote</span><span class="p">(</span>
        <span class="n">command_executor</span><span class="o">=</span><span class="n">remote_url</span><span class="p">,</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">get_html_from_url</span><span class="p">(</span><span class="n">url</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        gets html from url</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get text data from url using requests</span>
    <span class="n">driver</span> <span class="o">=</span> <span class="n">get_webdriver</span><span class="p">()</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="c1"># return html from page source</span>
    <span class="k">return</span> <span class="n">driver</span><span class="o">.</span><span class="n">page_source</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">get_html_from_url</span><span class="p">(</span><span class="s2">&quot;https://www.youtube.com/c/YahooFinance&quot;</span><span class="p">)</span>
    <span class="n">livestream_data</span> <span class="o">=</span> <span class="n">get_livestreams_from_html</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

    <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://www.youtube.com&quot;</span>
    <span class="c1"># check if LIVE or UPCOMING</span>
    <span class="k">for</span> <span class="n">livestream</span> <span class="ow">in</span> <span class="n">livestream_data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">livestream</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;LIVE&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;LIVE&quot;</span><span class="p">)</span>
            <span class="n">youtube_url</span> <span class="o">=</span> <span class="n">base_url</span> <span class="o">+</span> <span class="n">livestream</span><span class="p">[</span><span class="s2">&quot;watch_url&quot;</span><span class="p">]</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;youtube_url&quot;</span><span class="p">:</span> <span class="n">youtube_url</span><span class="p">,</span> <span class="s2">&quot;iteration&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="s2">&quot;YahooFinance&quot;</span><span class="p">}</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">livestream</span><span class="p">[</span><span class="s2">&quot;status&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;UPCOMING&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;UPCOMING&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;NONE&quot;</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> 
</pre></div>
</div>
<p>This code is using the Selenium WebDriver to automate the web browser and retrieve the HTML content of a YouTube channel. The channel URL is hardcoded as “<a class="reference external" href="https://www.youtube.com/c/YahooFinance">https://www.youtube.com/c/YahooFinance</a>” in the <code class="docutils literal notranslate"><span class="pre">get_html_from_url</span></code> function, but it could be updated to read from a configuration file, as noted in the TODO comment.</p>
<p>After retrieving the HTML, the code uses the <code class="docutils literal notranslate"><span class="pre">get_livestreams_from_html</span></code> function to extract information about the livestreams on the channel, if any. It then checks the status of each livestream, and if the status is “LIVE”, it prints the information, including the URL of the livestream on YouTube and some additional data. If the status is “UPCOMING”, the code exits with status code 0. If the status is neither “LIVE” nor “UPCOMING”, the code exits with status code 1.</p>
<section id="id5">
<h3>References<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><a class="github reference external" href="https://github.com/dli-invest/fdrtt/blob/main/livestream_scrapper.py">dli-invest/fdrtt</a></p></li>
<li><p><a class="github reference external" href="https://github.com/dli-invest/fdrtt">dli-invest/fdrtt</a></p></li>
</ul>
</section>
</section>
<section id="natural-gas-analysis">
<h2>Natural gas Analysis<a class="headerlink" href="#natural-gas-analysis" title="Permalink to this heading">#</a></h2>
<p>Gas prices fluctuate due to a variety of factors, including changes in the cost of crude oil, which is the primary raw material used to produce gasoline, as well as changes in supply and demand for gasoline, taxes, and other costs associated with refining, storing, and transporting gasoline. Additionally, geopolitical events, such as conflicts or natural disasters, can also affect gas prices by disrupting the global oil market.</p>
<p>Cyclical stocks are stocks that tend to be sensitive to the economic cycle, meaning their prices tend to rise and fall with the overall health of the economy. These stocks are often associated with industries that are heavily influenced by consumer spending, such as retail, consumer durables, and homebuilding.</p>
<p>Cyclical stocks tend to perform well during economic expansions and periods of low unemployment, as consumers have more disposable income to spend on non-essential goods and services. However, during economic downturns and recessions, when consumer spending decreases, the profits and stock prices of companies in cyclical industries tend to decline.</p>
<p>Examples of cyclical stocks include those in the automotive, construction, housing, and consumer discretionary sectors.</p>
<p>A 3-month moving average is a technical indicator that is used to smooth out short-term fluctuations in a stock or index’s price, and to help identify longer-term trends. It is calculated by taking the average of a stock or index’s closing price over the past three months.</p>
<p>The idea behind a moving average is that it helps to filter out “noise” in the stock or index’s price, and to make it easier to spot trends. By averaging out the closing prices over a longer period of time, such as three months, the moving average smooths out any short-term volatility in the stock or index’s price, and makes it easier to identify longer-term trends.</p>
<p>Traders often use moving averages to help identify buy and sell signals. For example, if a stock or index’s price is above its 3-month moving average, it may be considered to be in an uptrend, and traders may buy the stock or index. Conversely, if a stock or index’s price is below its 3-month moving average, it may be considered to be in a downtrend, and traders may sell the stock or index.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="c1"># calculate average from daily data from natural gas futures from yahoo finance</span>
<span class="kn">import</span> <span class="nn">yfinance</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">mplfinance</span> <span class="k">as</span> <span class="nn">mpf</span>

<span class="c1"># read NG=F 2 years worth of data</span>

<span class="n">nat_gas</span> <span class="o">=</span> <span class="n">yfinance</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;NG=F&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2021-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2023-01-01&quot;</span><span class="p">)</span>

<span class="n">nat_gas</span><span class="p">[</span><span class="s1">&#39;Month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">nat_gas</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="c1"># pad all date</span>
<span class="c1"># print(nat_gas.groupby(by=[&#39;Volume&#39;, &#39;Adj Close&#39;, pd.Grouper(key=&#39;Month&#39;, freq=&#39;3M&#39;)])[&#39;Open&#39;].agg(&#39;mean&#39;))</span>

<span class="n">mths_3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">end</span> <span class="o">=</span> <span class="n">nat_gas</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">freq</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">offsets</span><span class="o">.</span><span class="n">BQuarterEnd</span><span class="p">(),</span><span class="n">periods</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="c1"># mths_6 = pd.date_range(end = nat_gas.index[-1], freq=pd.offsets.MonthBegin(6),periods=4)</span>

<span class="n">mth3</span> <span class="o">=</span> <span class="p">(</span><span class="n">nat_gas</span>
         <span class="c1">#filter for last three months</span>
        <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">mths_3</span><span class="p">]</span>
        <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;Month&quot;</span><span class="p">,</span> <span class="s2">&quot;Volume&quot;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">avg_ng_last_3_months</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;Open&quot;</span><span class="p">,</span><span class="s2">&quot;mean&quot;</span><span class="p">))</span>
        <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mth3</span><span class="p">)</span>

<span class="c1"># for Bir.to (birchcliff energy, I use the following numbers for some estimations)</span>
<span class="c1"># random guess from last two quarters of profit</span>
<span class="c1"># at 4.558 assume 360 revenue for Q4 and 160M profit</span>
<span class="c1"># 475 revenue and 260M profit for Q4</span>
<span class="c1"># considering the investor presentation, thinking its closer to 360M revenue and 160 M profit.</span>
<span class="n">quarterly_profit</span> <span class="o">=</span> <span class="mi">160</span>
<span class="c1"># 	266.05M * 0.2</span>
<span class="c1"># if deliveries are 3 quarters behind then </span>


<span class="n">quarterly_dividend</span> <span class="o">=</span> <span class="mf">266.05</span> <span class="o">*</span> <span class="mf">0.2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">quarterly_dividend</span><span class="p">)</span>

<span class="n">remaining_revenue</span> <span class="o">=</span> <span class="n">quarterly_profit</span> <span class="o">-</span> <span class="n">quarterly_dividend</span>
<span class="nb">print</span><span class="p">(</span><span class="n">remaining_revenue</span><span class="p">)</span>
<span class="c1"># 176 debt</span>
<span class="n">total_debt</span> <span class="o">=</span> <span class="mi">176</span>

<span class="c1"># max debt reduction (they target to get to 50M USD in debt)</span>
<span class="n">min_debt_reduction</span> <span class="o">=</span> <span class="n">total_debt</span> <span class="o">-</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="n">min_debt_reduction</span><span class="p">)</span>
<span class="c1"># bunch of risk of falling gas prices, but with new supply reduction from russia, doubt it would be so bad.</span>

<span class="c1"># save fig</span>
<span class="n">mpf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">nat_gas</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s1">&#39;ohlc&#39;</span><span class="p">,</span><span class="n">mav</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span> <span class="n">volume</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;yahoo&#39;</span><span class="p">)</span> 
</pre></div>
</div>
<p><img alt="markdown" src="https://friendlyuser.github.io/imgs/2023/ng.png" /></p>
<p>This script appears to be using the yfinance library to download historical data for natural gas futures (NG=F) from Yahoo Finance, for the period between January 1, 2021 and January 1, 2023. It then uses the Pandas library to create a new column in the dataframe called “Month” which is populated with the date of the data point, and converts it to a datetime object.</p>
<p>It then uses the Pandas library to create a date range for the last 8 quarters, and filters the dataframe to only include data points from those quarters. It then groups the data by the “Month” column and the “Volume” column, and calculates the average “Open” value for each group, which it saves to a new column in the dataframe called “avg_ng_last_3_months”.</p>
<p>It also appears to be doing some calculations related to a company’s profit, dividend, and debt, but it’s not clear how these calculations relate to the data being downloaded or how they are being used.</p>
<p>After that it is using mplfinance library to plot Open high low and close prices of natural gas with 30, 60 and 90 moving averages, and volume, and then it’s saving the graph with the name ng.png.</p>
<p>There are several libraries in Python that can be used to create financial plots, including:</p>
<ul class="simple">
<li><p>Matplotlib: A widely-used library for creating static, animated, and interactive visualizations in Python. It can be used to create a wide variety of plots, including line plots, scatter plots, bar plots, and candlestick plots.</p></li>
<li><p>Plotly: A library for creating interactive visualizations in Python. It can be used to create a wide variety of plots, including line plots, scatter plots, bar plots, and candlestick plots.</p></li>
<li><p>mplfinance: A library built on top of matplotlib that is specifically designed for financial plotting. It can be used to create a wide variety of financial plots, including candlestick plots, barcharts and volume plots.</p></li>
<li><p>seaborn: A library for creating statistical visualizations in Python. It can be used to create a wide variety of plots, including line plots, scatter plots, bar plots, and heatmaps.</p></li>
<li><p>bokeh: A library for creating interactive visualizations in Python. It can be used to create a wide variety of plots, including line plots, scatter plots, bar plots, and candlestick plots.</p></li>
</ul>
<p>All of these libraries have their own strengths and weaknesses, and the best choice will depend on the specific needs of the project. Some are better for creating static plots, while others are better for creating interactive visualizations. Some are better for working with large datasets, while others are better for creating highly customized visualizations.</p>
<p>Most of the libraries mentioned above require a basic understanding of the plotting and visualization concepts, Some of the libraries like mplfinance are built on top of matplotlib and are more specialized to financial plots, making it easier to create charts like candlestick charts and other financial plots.</p>
<p>Climate change is expected to have a significant impact on gas consumption as the world shifts towards cleaner and more sustainable energy sources. As temperatures rise and weather patterns become more extreme, the demand for natural gas is expected to increase in certain sectors such as power generation, as it is considered a cleaner alternative to coal and oil. However, in other sectors such as transportation, the demand for natural gas may decrease as electric vehicles and other alternative fuel vehicles become more prevalent.</p>
<p>The use of natural gas for power generation is expected to increase as countries look to phase out coal and reduce their greenhouse gas emissions. Natural gas is a less carbon-intensive fossil fuel and can be used in combination with renewable energy sources such as wind and solar power to provide a flexible and reliable source of electricity.</p>
<p>However, the transportation sector is also a significant contributor to global greenhouse gas emissions, and there is a growing movement to shift away from fossil fuels and towards electric and alternative fuel vehicles. As a result, the demand for natural gas as a transportation fuel is expected to decrease in the long term.</p>
<p>Overall, the impact of climate change on gas consumption is complex and will depend on a variety of factors, including government policies, technological advancements, and consumer preferences. It’s important to note that natural gas can be used as a transition fuel to decrease the use of coal and oil in power production and make the transition to renewable energy sources.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chapters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="chap_10.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Chapter 10 Introduction to Data Science</p>
      </div>
    </a>
    <a class="right-next"
       href="conclusion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Conclusion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#using-argparse">Using argparse</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#convert-pdf-to-pngs">Convert pdf to pngs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chat-gpt-blog-generation">Chat gpt blog generation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#investor-document-downloader">Investor document downloader</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-subtitles-for-youtube-videos">Generate Subtitles for Youtube Videos</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scrapping-superbowl-results-with-pandas">Scrapping Superbowl results with pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-youtube-livestream-status">Getting youtube livestream status</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">References</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#natural-gas-analysis">Natural gas Analysis</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By FriendlyUser
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=365ca57ee442770a23c6"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=365ca57ee442770a23c6"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>